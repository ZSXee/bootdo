<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <process id="fengxian" name="非格式合同风险审批流程" isExecutable="true">
    <subProcess id="subprocess1" name="会签子流程">
      <multiInstanceLoopCharacteristics isSequential="false" activiti:collection="assigneeList" activiti:elementVariable="assignee">
        <completionCondition>${nrOfCompletedInstances/nrOfInstances == 1}</completionCondition>
      </multiInstanceLoopCharacteristics>
      <startEvent id="startevent2" name="Start"></startEvent>
      <userTask id="usertask4" name="部室员工审批" activiti:candidateGroups="${assignee}">
        <extensionElements>
          <activiti:taskListener event="complete" class="com.bootdo.activiti.listener.H3TaksListener"></activiti:taskListener>
        </extensionElements>
      </userTask>
      <sequenceFlow id="flow14" sourceRef="startevent2" targetRef="usertask4"></sequenceFlow>
      <userTask id="usertask5" name="部室负责人审批" activiti:assignee="${applyUserId}"></userTask>
      <exclusiveGateway id="exclusivegateway7" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow16" sourceRef="usertask5" targetRef="exclusivegateway7"></sequenceFlow>
      <sequenceFlow id="flow15" sourceRef="usertask4" targetRef="usertask5">
        <extensionElements>
          <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H1TaksListener"></activiti:executionListener>
        </extensionElements>
      </sequenceFlow>
      <endEvent id="endevent3" name="End"></endEvent>
      <sequenceFlow id="flow24" sourceRef="exclusivegateway7" targetRef="endevent3">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 1}]]></conditionExpression>
      </sequenceFlow>
      <userTask id="usertask6" name="部室员工修改" activiti:assignee="${applyUserId}"></userTask>
      <sequenceFlow id="flow19" sourceRef="usertask6" targetRef="usertask5">
        <extensionElements>
          <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H1TaksListener"></activiti:executionListener>
        </extensionElements>
      </sequenceFlow>
      <endEvent id="endevent4" name="End"></endEvent>
      <sequenceFlow id="flow17" sourceRef="exclusivegateway7" targetRef="endevent4">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 1}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow18" sourceRef="exclusivegateway7" targetRef="usertask6">
        <extensionElements>
          <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H4TaksListener"></activiti:executionListener>
        </extensionElements>
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 0}]]></conditionExpression>
      </sequenceFlow>
    </subProcess>
    <startEvent id="startevent1" name="Start" activiti:formKey="/contact/tbContactInfo/add"></startEvent>
    <userTask id="usertask2" name="风险部负责人审批" activiti:assignee="${applyUserId}"></userTask>
    <exclusiveGateway id="exclusivegateway5" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow5" sourceRef="usertask2" targetRef="exclusivegateway5"></sequenceFlow>
    <userTask id="usertask3" name="合规风险部修改" activiti:assignee="${applyUserId}"></userTask>
    <endEvent id="endevent1" name="End"></endEvent>
    <sequenceFlow id="flow6" name="通过" sourceRef="exclusivegateway5" targetRef="endevent1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 1}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow7" name="未通过" sourceRef="exclusivegateway5" targetRef="usertask3">
      <extensionElements>
        <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H8TaksListener"></activiti:executionListener>
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 0}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="exclusivegateway6" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow9" sourceRef="usertask3" targetRef="exclusivegateway6"></sequenceFlow>
    <endEvent id="endevent2" name="End"></endEvent>
    <sequenceFlow id="flow10" name="未通过" sourceRef="exclusivegateway6" targetRef="endevent2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 0}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="exclusivegateway8" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow13" name="会签" sourceRef="exclusivegateway8" targetRef="subprocess1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${countersign == 1}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow25" sourceRef="startevent1" targetRef="exclusivegateway8"></sequenceFlow>
    <sequenceFlow id="flow26" name="非会签" sourceRef="exclusivegateway8" targetRef="usertask2">
      <extensionElements>
        <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H1TaksListener"></activiti:executionListener>
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${countersign == 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow27" name="通过" sourceRef="exclusivegateway6" targetRef="exclusivegateway8">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${pass == 1}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow28" sourceRef="subprocess1" targetRef="usertask2">
      <extensionElements>
        <activiti:executionListener event="take" class="com.bootdo.activiti.listener.H6TaksListener"></activiti:executionListener>
      </extensionElements>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_fengxian">
    <bpmndi:BPMNPlane bpmnElement="fengxian" id="BPMNPlane_fengxian">
      <bpmndi:BPMNShape bpmnElement="subprocess1" id="BPMNShape_subprocess1">
        <omgdc:Bounds height="242.0" width="521.0" x="75.0" y="-54.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent2" id="BPMNShape_startevent2">
        <omgdc:Bounds height="35.0" width="35.0" x="105.0" y="-7.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask4" id="BPMNShape_usertask4">
        <omgdc:Bounds height="55.0" width="105.0" x="165.0" y="-17.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask5" id="BPMNShape_usertask5">
        <omgdc:Bounds height="55.0" width="105.0" x="315.0" y="-17.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway7" id="BPMNShape_exclusivegateway7">
        <omgdc:Bounds height="40.0" width="40.0" x="465.0" y="-10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent3" id="BPMNShape_endevent3">
        <omgdc:Bounds height="35.0" width="35.0" x="550.0" y="-7.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask6" id="BPMNShape_usertask6">
        <omgdc:Bounds height="55.0" width="105.0" x="315.0" y="106.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent4" id="BPMNShape_endevent4">
        <omgdc:Bounds height="35.0" width="35.0" x="550.0" y="-7.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="210.0" y="261.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask2" id="BPMNShape_usertask2">
        <omgdc:Bounds height="55.0" width="105.0" x="470.0" y="250.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway5" id="BPMNShape_exclusivegateway5">
        <omgdc:Bounds height="40.0" width="40.0" x="620.0" y="258.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask3" id="BPMNShape_usertask3">
        <omgdc:Bounds height="55.0" width="105.0" x="470.0" y="357.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="705.0" y="261.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway6" id="BPMNShape_exclusivegateway6">
        <omgdc:Bounds height="40.0" width="40.0" x="502.0" y="457.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="35.0" width="35.0" x="638.0" y="460.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway8" id="BPMNShape_exclusivegateway8">
        <omgdc:Bounds height="40.0" width="40.0" x="315.0" y="258.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="504.87951807228916" y="10.120481927710843"></omgdi:waypoint>
        <omgdi:waypoint x="550.0003213869223" y="10.393941341738932"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow28" id="BPMNEdge_flow28">
        <omgdi:waypoint x="442.9916864608076" y="188.0"></omgdi:waypoint>
        <omgdi:waypoint x="498.0700712589074" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
        <omgdi:waypoint x="485.0" y="30.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="133.0"></omgdi:waypoint>
        <omgdi:waypoint x="420.0" y="133.27659574468086"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="367.5" y="106.0"></omgdi:waypoint>
        <omgdi:waypoint x="367.5" y="38.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow24" id="BPMNEdge_flow24">
        <omgdi:waypoint x="504.87951807228916" y="10.120481927710843"></omgdi:waypoint>
        <omgdi:waypoint x="550.0003213869223" y="10.393941341738932"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="335.0472813238771" y="258.0472813238771"></omgdi:waypoint>
        <omgdi:waypoint x="335.2132701421801" y="188.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow14" id="BPMNEdge_flow14">
        <omgdi:waypoint x="140.0" y="10.5"></omgdi:waypoint>
        <omgdi:waypoint x="165.0" y="10.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="244.99981071156228" y="278.41860553157414"></omgdi:waypoint>
        <omgdi:waypoint x="315.0925925925926" y="278.0925925925926"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow15" id="BPMNEdge_flow15">
        <omgdi:waypoint x="270.0" y="10.5"></omgdi:waypoint>
        <omgdi:waypoint x="315.0" y="10.5"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow26" id="BPMNEdge_flow26">
        <omgdi:waypoint x="354.9468085106383" y="277.9468085106383"></omgdi:waypoint>
        <omgdi:waypoint x="470.0" y="277.64"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
        <omgdi:waypoint x="420.0" y="10.27659574468085"></omgdi:waypoint>
        <omgdi:waypoint x="465.08474576271186" y="10.084745762711865"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="502.0" y="477.0"></omgdi:waypoint>
        <omgdi:waypoint x="335.0" y="477.0"></omgdi:waypoint>
        <omgdi:waypoint x="335.0" y="298.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow5" id="BPMNEdge_flow5">
        <omgdi:waypoint x="575.0" y="277.72340425531917"></omgdi:waypoint>
        <omgdi:waypoint x="620.0847457627119" y="277.91525423728814"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="659.8795180722891" y="278.12048192771084"></omgdi:waypoint>
        <omgdi:waypoint x="705.0003213869223" y="278.3939413417389"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
        <omgdi:waypoint x="640.0" y="298.0"></omgdi:waypoint>
        <omgdi:waypoint x="640.0" y="384.0"></omgdi:waypoint>
        <omgdi:waypoint x="575.0" y="384.27659574468083"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
        <omgdi:waypoint x="541.9253731343283" y="477.07462686567163"></omgdi:waypoint>
        <omgdi:waypoint x="638.0001227385424" y="477.4344573885339"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
        <omgdi:waypoint x="522.3513513513514" y="412.0"></omgdi:waypoint>
        <omgdi:waypoint x="522.1075268817204" y="457.10752688172045"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>